* DESTRING DATA

destring avgagefirstinv, replace float dpcomma
destring avground, replace float dpcomma
destring avgroundfirstinv, replace float dpcomma
destring percsyndfirstinv, replace float dpcomma
destring avgcultdistcs, replace float dpcomma
destring percsubsidinv, replace float dpcomma
destring percnewind, replace float dpcomma
destring percnewcountry, replace float dpcomma
destring geoentropy, replace float dpcomma
destring indtotentropy, replace float dpcomma
destring indunrentropy, replace float dpcomma
destring indrelentropy, replace float dpcomma
destring percinvoutside4digit, replace float percent
destring percinvoutside2digit, replace float percent
destring avgivc1, replace float percent
destring avgivc2, replace float percent
destring avgfinint1, replace float percent
destring avgfinint2, replace float percent
destring avgparent1ivc, replace float percent
destring avgparent2ivc, replace float percent
destring avgparent2finint, replace float percent
destring cultdistcp, replace float dpcomma
destring percipoma, replace float percent
destring firstroundfreq, replace float percent
destring medianroundfirstinv, replace float dpcomma
destring percfirstinv, replace float percent
destring percipoma10y, replace float percent
destring ethnicityentropy, replace float dpcomma
destring percfemalemanagers, replace float percent
destring percalliances20y, replace float percent
destring percstartupallied20y, replace float percent
destring percalliances5y, replace float percent
destring percstartupallied5y, replace float percent
destring perctechalliancesafterinv20y, replace float percent
destring perctechalliancesafterinv5y, replace float percent
destring percacquisitions20y, replace float percent
destring percacquisitions5y, replace float percent
destring avgalliances20y, replace float dpcomma
destring avgalliances5y, replace float dpcomma
destring percalliancesafterinv20y, replace float percent
destring percalliancesafterinv5y, replace float percent
destring perctechalliances20y, replace float percent
destring perctechalliances5y, replace float percent
destring perccommalliances20y, replace float percent
destring perccommalliances5y, replace float percent
destring percacquisitionsinternal20y, replace float percent
destring percacquisitionsinternal5y, replace float percent
destring productivity, replace float dpcomma
destring perccommalliancesafterinv5y, replace float percent
destring percacquisitionsexternal5y, replace float percent
destring percipo5y, replace float percent

gen logproductivity = log(1+productivity)



* PCA


* INVESTMENT STRATEGY:
global ncomp1 5
global x1list avground avgroundfirstinv firstroundfreq percsyndfirstinv percnewcountry avggeodistcs geoentropy percnewind indtotentropy indunrentropy percinvoutside4digit percinvoutside2digit
pca $x1list, comp($ncomp1) blanks(.3)
rotate, varimax blanks(.3)
rotate, clear

predict latestage industrydiversification geogdiversification industryexploration syndacate


* ORGANIZATIONAL STRUCTURE:
global ncomp2 2
global x2list percsubsidinv cultdistcp geodistcp
pca $x2list, comp($ncomp2) blanks(.3)

predict distanceparent autonomy 


* HUMAN CAPITAL:
global ncomp3 3
global x3list avgfinint1 avgparent1ivc ethnicityentropy percfemalemanagers
pca $x3list, comp($ncomp3) blanks(.3)
rotate, varimax blanks(.3)
rotate, clear

predict managersparent femalemanagers ethnicitydiversification


* PERFORMANCE: no PCA needed


* CVC SIZE:
global ncomp 1
global xlist numinv numstartup nummanagers
pca $xlist, comp($ncomp) blanks(.33)

predict cvcsize



* CLUSTERING

* K-MEANS ONLY

cluster kmeans cvcsize latestage industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, k(3) measure(L2squared) name(clu2_kmeans) start(krandom)

hist clu2_kmeans, addl frequency


* WARDSLINKAGE + K-MEANS

cluster wardslinkage cvcsize earliness industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, measure(L2squared)

cluster dendrogram _clus_1, cutnumber(20)

*stopping rules
* calinski rule --> piu grande F meglio 
cluster stop _clus_1, rule(calinski)
* duda-hart rule --> piu grande Je(1)/Je(2) e piu' piccolo T
cluster stop _clus_1, rule(duda)


*SOLUZIONE A 3 CLUSTER 
*generate cluster variable
cluster generate clu1 = groups(3), name(_clus_1)

*plot cluster frequencies
hist clu1, addl frequency

*K-means cluster
cluster kmeans cvcsize earliness industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, k(3) measure(L2squared) start(group(clu1)) keepcenters
rename _clus_2 clu2_kmeans
hist clu2_kmeans, addl frequency
