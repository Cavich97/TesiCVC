* DESTRING DATA

destring avgagefirstinv, replace float dpcomma
destring avground, replace float dpcomma
destring avgroundfirstinv, replace float dpcomma
destring percsyndfirstinv, replace float dpcomma
destring avgcultdistcs, replace float dpcomma
destring percsubsidinv, replace float dpcomma
destring percnewind, replace float dpcomma
destring percnewcountry, replace float dpcomma
destring geoentropy, replace float dpcomma
destring indtotentropy, replace float dpcomma
destring indunrentropy, replace float dpcomma
destring indrelentropy, replace float dpcomma
destring percinvoutside4digit, replace float percent
destring percinvoutside2digit, replace float percent
destring avgivc1, replace float percent
destring avgivc2, replace float percent
destring avgfinint1, replace float percent
destring avgfinint2, replace float percent
destring avgparent1ivc, replace float percent
destring avgparent2ivc, replace float percent
destring avgparent2finint, replace float percent
destring cultdistcp, replace float dpcomma
destring percipoma, replace float percent
destring firstroundfreq, replace float percent
destring medianroundfirstinv, replace float dpcomma
destring percfirstinv, replace float percent
destring percipoma10y, replace float percent
destring ethnicityentropy, replace float dpcomma
destring percfemalemanagers, replace float percent
destring percalliances20y, replace float percent
destring percstartupallied20y, replace float percent
destring percalliances5y, replace float percent
destring percstartupallied5y, replace float percent
destring perctechalliancesafterinv20y, replace float percent
destring perctechalliancesafterinv5y, replace float percent
destring percacquisitions20y, replace float percent
destring percacquisitions5y, replace float percent
destring avgalliances20y, replace float dpcomma
destring avgalliances5y, replace float dpcomma
destring percalliancesafterinv20y, replace float percent
destring percalliancesafterinv5y, replace float percent
destring perctechalliances20y, replace float percent
destring perctechalliances5y, replace float percent
destring perccommalliances20y, replace float percent
destring perccommalliances5y, replace float percent
destring percacquisitionsinternal20y, replace float percent
destring percacquisitionsinternal5y, replace float percent
destring productivity, replace float dpcomma
destring perccommalliancesafterinv5y, replace float percent
destring percacquisitionsexternal5y, replace float percent
destring percipo5y, replace float percent

gen logproductivity = log(1+productivity)



* PCA


* INVESTMENT STRATEGY:
global ncomp1 5
global x1list avground avgroundfirstinv firstroundfreq percsyndfirstinv percnewcountry avggeodistcs geoentropy percnewind indtotentropy indunrentropy percinvoutside4digit percinvoutside2digit
pca $x1list, comp($ncomp1) blanks(.3)
rotate, varimax blanks(.3)
rotate, clear

predict latestage industrydiversification geogdiversification industryexploration syndacate


* ORGANIZATIONAL STRUCTURE:
global ncomp2 2
global x2list percsubsidinv cultdistcp geodistcp
pca $x2list, comp($ncomp2) blanks(.3)

predict distanceparent autonomy 


* HUMAN CAPITAL:
global ncomp3 3
global x3list avgfinint1 avgparent1ivc ethnicityentropy percfemalemanagers
pca $x3list, comp($ncomp3) blanks(.3)
rotate, varimax blanks(.3)
rotate, clear

predict managersparent femalemanagers ethnicitydiversification


* PERFORMANCE: no PCA needed


* CVC SIZE:
global ncomp 1
global xlist numinv numstartup nummanagers
pca $xlist, comp($ncomp) blanks(.33)

predict cvcsize



* CLUSTERING 


cluster wardslinkage cvcsize latestage industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, measure(L2squared)
cluster dendrogram _clus_1, cutnumber(20)

* stopping rules: 
* calinski rule --> piu grande F meglio 
cluster stop _clus_1, rule(calinski)
* duda-hart rule --> piu grande Je(1)/Je(2) e piu' piccolo T
cluster stop _clus_1, rule(duda)

* 1) WARDSLINKAGE (optimal number) + K-MEANS (clustering)
cluster kmeans cvcsize latestage industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, k(6) measure(L2squared) start(krandom)
rename _clus_2 CVCtype
hist CVCtype, addl frequency


* 2) impose WARDSLINKAGE to K-MEANS
*generate cluster variable
cluster generate clu1 = groups(6), name(_clus_1)
hist clu1, addl frequency
*K-means cluster
cluster kmeans cvcsize latestage industrydiversification geogdiversification industryexploration syndacate distanceparent autonomy managersparent femalemanagers ethnicitydiversification logproductivity, k(6) measure(L2squared) start(group(clu1)) keepcenters
rename _clus_2 CVCtype
hist CVCtype, addl frequency



* Configiuration dummies
tabulate CVCtype, gen(config)


* K-Wallis H test
kwallis cvcsize, by(CVCtype)
kwallis latestage, by(CVCtype)
kwallis industrydiversification, by(CVCtype)
kwallis geogdiversification, by(CVCtype)
kwallis industryexploration, by(CVCtype)
kwallis syndacate, by(CVCtype)
kwallis distanceparent, by(CVCtype)
kwallis autonomy, by(CVCtype)
kwallis managersparent, by(CVCtype)
kwallis femalemanagers, by(CVCtype)
kwallis ethnicitydiversification, by(CVCtype)
kwallis logproductivity, by(CVCtype)

* Dunn's test with Bonferroni adjustment
dunntest cvcsize, by(CVCtype) ma(bonferroni)
dunntest latestage, by(CVCtype) ma(bonferroni)
dunntest industrydiversification, by(CVCtype) ma(bonferroni)
dunntest geogdiversification, by(CVCtype) ma(bonferroni)
dunntest industryexploration, by(CVCtype) ma(bonferroni)
dunntest syndacate, by(CVCtype) ma(bonferroni)
dunntest distanceparent, by(CVCtype) ma(bonferroni)
dunntest autonomy, by(CVCtype) ma(bonferroni)
dunntest managersparent, by(CVCtype) ma(bonferroni)
dunntest femalemanagers, by(CVCtype) ma(bonferroni)
dunntest ethnicitydiversification, by(CVCtype) ma(bonferroni)
dunntest logproductivity, by(CVCtype) ma(bonferroni)


* Wilkoxon-Mannâ€“Whitney U test

ranksum cvcsize if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum cvcsize if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum cvcsize if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum cvcsize if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum cvcsize if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum cvcsize if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum cvcsize if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum cvcsize if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum cvcsize if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum cvcsize if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum cvcsize if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum cvcsize if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum cvcsize if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum cvcsize if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum cvcsize if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum latestage if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum latestage if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum latestage if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum latestage if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum latestage if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum latestage if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum latestage if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum latestage if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum latestage if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum latestage if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum latestage if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum latestage if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum latestage if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum latestage if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum latestage if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum industrydiversification if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum industrydiversification if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum industrydiversification if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum industrydiversification if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum industrydiversification if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum industrydiversification if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum industrydiversification if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum industrydiversification if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum industrydiversification if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum industrydiversification if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum industrydiversification if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum industrydiversification if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum industrydiversification if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum industrydiversification if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum industrydiversification if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum geogdiversification if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum geogdiversification if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum geogdiversification if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum geogdiversification if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum geogdiversification if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum geogdiversification if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum geogdiversification if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum geogdiversification if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum geogdiversification if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum geogdiversification if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum geogdiversification if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum geogdiversification if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum geogdiversification if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum geogdiversification if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum geogdiversification if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum industryexploration if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum industryexploration if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum industryexploration if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum industryexploration if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum industryexploration if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum industryexploration if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum industryexploration if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum industryexploration if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum industryexploration if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum industryexploration if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum industryexploration if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum industryexploration if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum industryexploration if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum industryexploration if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum industryexploration if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum syndacate if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum syndacate if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum syndacate if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum syndacate if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum syndacate if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum syndacate if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum syndacate if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum syndacate if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum syndacate if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum syndacate if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum syndacate if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum syndacate if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum syndacate if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum syndacate if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum syndacate if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum distanceparent if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum distanceparent if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum distanceparent if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum distanceparent if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum distanceparent if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum distanceparent if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum distanceparent if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum distanceparent if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum distanceparent if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum distanceparent if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum distanceparent if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum distanceparent if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum distanceparent if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum distanceparent if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum distanceparent if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum autonomy if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum autonomy if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum autonomy if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum autonomy if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum autonomy if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum autonomy if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum autonomy if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum autonomy if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum autonomy if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum autonomy if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum autonomy if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum autonomy if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum autonomy if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum autonomy if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum autonomy if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum managersparent if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum managersparent if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum managersparent if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum managersparent if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum managersparent if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum managersparent if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum managersparent if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum managersparent if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum managersparent if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum managersparent if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum managersparent if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum managersparent if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum managersparent if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum managersparent if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum managersparent if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum femalemanagers if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum femalemanagers if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum femalemanagers if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum femalemanagers if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum femalemanagers if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum femalemanagers if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum femalemanagers if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum femalemanagers if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum femalemanagers if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum femalemanagers if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum femalemanagers if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum femalemanagers if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum femalemanagers if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum femalemanagers if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum femalemanagers if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum ethnicitydiversification if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum ethnicitydiversification if CVCtype==5 | CVCtype==6, by(CVCtype)

ranksum logproductivity if CVCtype==1 | CVCtype==2, by(CVCtype)
ranksum logproductivity if CVCtype==1 | CVCtype==3, by(CVCtype)
ranksum logproductivity if CVCtype==1 | CVCtype==4, by(CVCtype)
ranksum logproductivity if CVCtype==1 | CVCtype==5, by(CVCtype)
ranksum logproductivity if CVCtype==1 | CVCtype==6, by(CVCtype)
ranksum logproductivity if CVCtype==2 | CVCtype==3, by(CVCtype)
ranksum logproductivity if CVCtype==2 | CVCtype==4, by(CVCtype)
ranksum logproductivity if CVCtype==2 | CVCtype==5, by(CVCtype)
ranksum logproductivity if CVCtype==2 | CVCtype==6, by(CVCtype)
ranksum logproductivity if CVCtype==3 | CVCtype==4, by(CVCtype)
ranksum logproductivity if CVCtype==3 | CVCtype==5, by(CVCtype)
ranksum logproductivity if CVCtype==3 | CVCtype==6, by(CVCtype)
ranksum logproductivity if CVCtype==4 | CVCtype==5, by(CVCtype)
ranksum logproductivity if CVCtype==4 | CVCtype==6, by(CVCtype)
ranksum logproductivity if CVCtype==5 | CVCtype==6, by(CVCtype)









